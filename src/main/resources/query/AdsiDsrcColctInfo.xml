<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE mapper PUBLIC '-//mybatis.org//DTD Mapper 3.0//EN' 'http://mybatis.org/dtd/mybatis-3-mapper.dtd'>

<mapper namespace='com.neighbor21.ggits.common.mapper.AdsiDsrcColctInfoMapper'>
    <select id="findRecentListByRseId" resultType="adsiDsrcColctInfo">
        SELECT
            ADCI.DSRC_SCTN_ID
             ,round(AVG(ADCI.SPEED),0) AS speed
             ,ADSI.DSRC_SCTN_NM
             ,ADSI.DSRC_SCTN_LEN
             ,ADSI.ROAD_GRD
             ,ADSI.MIN_LIMIT_SPEED
             ,ADSI.MAX_LIMIT_SPEED
             ,ADSI.START_RSE_ID
             ,ADSI.END_RSE_ID
        FROM adsi_dsrc_colct_info_cur ADCI
                 INNER JOIN BIGDATA.EXT_ADSI_DSRC_SCTN_INFO ADSI ON ADCI.DSRC_SCTN_ID = ADSI.DSRC_SCTN_ID and adsi.mng_inst_cd = adci.mng_inst_cd
        WHERE
            ADSI.START_RSE_ID = #{rseId}
           OR ADSI.END_RSE_ID = #{rseId}
        group by
            ADCI.DSRC_SCTN_ID
               ,ADSI.DSRC_SCTN_NM
               ,ADSI.DSRC_SCTN_LEN
               ,ADSI.ROAD_GRD
               ,ADSI.MIN_LIMIT_SPEED
               ,ADSI.MAX_LIMIT_SPEED
               ,ADSI.START_RSE_ID
               ,ADSI.END_RSE_ID
    </select>
</mapper>
