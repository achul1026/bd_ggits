<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE mapper PUBLIC '-//mybatis.org//DTD Mapper 3.0//EN' 'http://mybatis.org/dtd/mybatis-3-mapper.dtd'>

<mapper namespace='com.neighbor21.ggits.common.mapper.MrtCndcyPathLinkInfoMapper'>

    <select id="findAllByCandRouteId" resultType="mrtCndcyPathLinkInfo">
        SELECT
            MCPLI.ST_LINK_ID ,
            MCPLI.CAND_ROUTE_ID,
            MCPLI.BTC_ID,
            MCPLI.BASEYM,
            CGSL.ROAD_NAME ,
            CGSL.ROAD_RANK ,
            MCPAI.LENGTH ,
            MCPAI.LENGTH_RATIO ,
            MCPAI.SCORE,
            MCPAI.SCORE_IMPRV,
            MCPAI.LENGTH_VAR,
            MCPAI.NUM_PSNGR,
            MCPAI.NUM_PSNGR_VAR,
            ST_ASGEOJSON(ST_LINEMERGE(CGSL.GEOMETRY)) AS GEOJSON
        FROM
            MRT_CNDCY_PATH_LINK_INFO MCPLI
                INNER JOIN MRT_CNDCY_PATH_ADD_INFO MCPAI ON MCPLI.CAND_ROUTE_ID = MCPAI.CAND_ROUTE_ID
                AND MCPLI.BTC_ID = MCPAI.BTC_ID AND MCPLI.BASEYM = MCPAI.BASEYM
                INNER JOIN C_GM_STD_LINK CGSL ON MCPLI.ST_LINK_ID = CGSL.LINK_ID
        WHERE
            MCPLI.CAND_ROUTE_ID = #{candRouteId}
        and MCPAI.obj_func_id = '2'
        AND MCPLI.BASEYM = #{baseym}
        AND MCPLI.BTC_ID = #{btcId}
        ORDER BY MCPLI.LINK_SEQ ASC
    </select>

</mapper>
